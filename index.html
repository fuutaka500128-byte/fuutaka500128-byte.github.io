<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>博多駅 新幹線案内</title>

<style>
body {
  margin: 0;
  background: black;
  overflow: hidden;
  font-family: -apple-system, BlinkMacSystemFont,
               "Hiragino Kaku Gothic ProN",
               "Yu Gothic", Meiryo, sans-serif;
}

/* テロップ全体 */
#ticker {
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 64px;
  overflow: hidden;
}

/* スクロール本体 */
#track {
  display: inline-flex;
  align-items: center;
  white-space: nowrap;
  animation: scroll 50s linear infinite;
}

/* 各列車 */
.item {
  display: inline-flex;
  align-items: center;
  margin-right: 12px;   /* ← 見切り間隔 */
  font-size: 28px;
}

/* 列車名 */
.train {
  font-weight: bold;
  margin-right: 6px;
}

/* 時刻・行先は白 */
.time,
.dest {
  color: white;
  margin-right: 6px;
}

/* 種別色 */
.nozomi  { color: #FFD700; }
.hikari  { color: #FF3B30; }
.kodama  { color: #007AFF; }
.sakura  { color: #FF69B4; }
.mizuho  { color: #FF9500; }
.tsubame { color: #5AC8FA; }

/* スクロール */
@keyframes scroll {
  0%   { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
}
</style>
</head>

<body>

<div id="ticker">
  <div id="track"></div>
</div>

<script>
async function loadTimetable() {
  try {
    const response = await fetch("hakata.json");
    if (!response.ok) throw new Error("JSON読み込み失敗");

    const data = await response.json();
    const track = document.getElementById("track");
    track.innerHTML = "";

    const now = new Date();
    const nowMinutes = now.getHours() * 60 + now.getMinutes();

    data.trains.forEach(train => {
      const [h, m] = train.time.split(":").map(Number);
      const trainMinutes = h * 60 + m;

      /* 過去列車は表示しない */
      if (trainMinutes < nowMinutes) return;

      const item = document.createElement("div");
      item.className = "item";

      const trainSpan = document.createElement("span");
      trainSpan.className = `train ${train.service}`;
      trainSpan.textContent = `${train.service_ja}${train.number}`;

      const timeSpan = document.createElement("span");
      timeSpan.className = "time";
      timeSpan.textContent = train.time;

      const destSpan = document.createElement("span");
      destSpan.className = "dest";
      destSpan.textContent = train.destination;

      item.appendChild(trainSpan);
      item.appendChild(timeSpan);
      item.appendChild(destSpan);

      track.appendChild(item);
    });

  } catch (e) {
    console.error(e);
  }
}

/* 初回表示 */
loadTimetable();

/* 1分ごとに自動更新 */
setInterval(loadTimetable, 60000);
</script>

</body>
</html>